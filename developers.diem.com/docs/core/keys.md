---
id: keys
title: Validator Keys and Roles
sidebar_label: Keys
---

## Overview

Each node in the Diem Blockchain manages several different cryptographic keys in order to securely participate in the Diem Payment Network (LPN). These keys are used to
- Authenticate participants: For example, they are used to identify validators in the LPN.
- Protect the integrity and confidentiality of security-critical data: For example, keys are used to secure proposal votes during consensus.

To allow nodes in the LPN to manage cryptographic keys securely, the Diem Blockchain defines an explicit key-role hierarchy on the blockchain: a role-based hierarchy that defines the ownership and management of individual keys with entities that have been granted roles and permissions in the network. Using a key-role hierarchy, the Diem Blockchain can better enforce privileged separation between participants, as well as allow cryptographic keys to be modified dynamically, for example, during key rotations.

## Key-role hierarchy

The key-role hierarchy defined for each validator node in the LPN is as follows:

### Owner key
Each validator node in the Diem Blockchain is assigned an owner. The owner is the entity responsible for the validator node. In the LPN, validator owners must be members of the Diem Association. To represent validator owners on-chain, each validator holds a unique owner account that has been granted the validator role. Each owner account has a corresponding owner key (i.e., the authentication key for the account), and the owner key is responsible for authenticating transactions on behalf of the owner account, such as signing transactions that can spend funds held in the owner account.

### Operator key
In addition to the owners defined above, validators in the LPN may also be assigned an operator by the validator owner. Validator operators are participants in the LPN, approved by Diem Networks, who are chosen by a validator owner to operate and run each validator node on behalf of the validator owner, including authenticating transactions on behalf of the validator owner. This allows validator owners to delegate the day-to-day responsibility of running and managing validators\ to Diem Networks- approved parties. Similar to owners, validator operators hold unique accounts on-chain that have been granted the validator_operator role. Each operator account requires an operator key (i.e., the authentication key for the account), which is responsible for authenticating transactions on behalf of the operator. Using the operator key, validator operators can update the on-chain state of each validator node, for example, update and/or modify the validator configurations published for each validator node on the Diem Blockchain.

>
> **Note**: If a validator owner decides not to delegate the management of their node to a third party validator > operator, the validator owner account will be the one responsible for performing the actions of the operator, for
> example, managing the validator configurations published on-chain.
>

### Consensus key
To ensure the safety and liveness of the consensus algorithm, validators in the LPN must authenticate and sign vote proposals. To achieve this, each validator node registers its consensus key on-chain: the key that should be used to authenticate the validity of any vote signature coming from the validator. Similar to authentication keys for accounts, consensus keys are Ed25519 cryptographic keys. To identify the consensus key of each validator node, their Ed25519 public key is published on-chain in their validator configuration. This allows other validators in the network to authenticate votes using the signatures generated by the corresponding Ed25519 private key. Moreover, by publishing these keys on-chain, it allows validator owners and operators to update these should they need.

### Validator/FullNode network key
Finally, to allow validators and validator-operated FullNodes to communicate securely in the LPN, each validator node also publishes its validator network key and full node network key in the on-chain validator configuration for the validator node. These are X25519 elliptic curve key pairs, where the public x25519 key is published in the validator configuration on-chain, and the x25519 private key is held securely by the node to authenticate network communication in the LPN. This allows other participants in the network to identify these validators, for example, to authenticate that they are indeed talking to the correct endpoint. Similar to the consensus key, these network keys can be updated by republishing the validator configurations on-chain.


## Key management

### Storing keys securely
To enforce privileged separation in the LPN and maintain the security properties of the key-role hierarchy, it is essential that cryptographic keys are stored securely. This aids in preventing key compromise or loss. As such, we identify the security requirements of each of the keys managed by validators and the way that these keys should be stored:

#### Owner keys
Given that the owner key has permissions to delegate an operator, this key requires the highest levels of security. If the validator owner chooses to elect a third party operator, this key will be required very infrequently, and thus it should be held in cold storage (i.e., offline). However, if the validator owner wishes to operate their own validator (i.e., elects not to choose a third party operator), this key will require moderately frequent access (e.g., to update the validator configurations on-chain), and thus it should be held in a high security storage environment (e.g., an HSM).

#### Operator key
If a third party validator operator has been selected by a validator owner, the operator key is granted permissions to update all cryptographic keys held within the validator configuration for that node. As such, this key only needs to be used moderately frequently, and thus should also be held in a high security storage environment (e.g., an HSM).

#### Consensus key
The consensus key is actively required for each validator node to participate in consensus. As a result, it is used frequently by each validator node, and for performance reasons is generally required to be held in hot storage on the validator node (e.g., in memory).

#### Validator/FullNode network key
The validator network key and full node network key are actively used during the construction and operation of communication channels in the LPN. As a result, they are similar to the consensus key in the sense that they should be stored close to the node to allow efficient network communication.


### Performing key rotations

As outlined above, one of the benefits of employing the key-role hierarchy for validators is the ability to update (i.e., rotate) cryptographic keys. This helps to provide freshness for keys and mitigates against long-range attacks, where keys are compromised and gathered over long periods of time. As a result, each of the keys managed by a validator node can and should be rotated in a timely manner:

#### Owner and operator keys
Both owner and operator keys are account-specific authentication keys. As such, they can be rotated efficiently by submitting key rotation transactions to the blockchain.

#### Consensus and Validator/FullNode network keys
The consensus key, validator network key, and full node network key are all published on-chain under the validator configuration of a validator node. As a result, they can subsequently be rotated by either the validator owner or operator when a new validator configuration is uploaded to the blockchain.


#### Reference

- [Manage Keys](manage-keys.md)
- [Stages of a Transaction](life-of-a-transaction.md)
- [My First Transaction](my-first-transaction.md)
- [Account Concepts](accounts.md)
- [Key Concepts](diem-protocol.md)
- [Transaction Types](transaction-types.md)
